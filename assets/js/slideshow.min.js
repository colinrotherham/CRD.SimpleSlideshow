/*
	Copyright (c) 2012 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};
	CRD.Slideshow=function(U,H,I){function J(a){$.each(a,function(a,b){d[a]=b})}function k(){d.isManual||(K=setTimeout(function(){g()},d.interval))}function x(){clearTimeout(L);clearTimeout(K)}function M(a){g(a,{isPrev:!1})}function N(a){g(a,{isPrev:!0})}function g(a,c){var w=$(this),e=c&&c.slide,f=b.index;if(!n){p=c&&c.isPrev;if(w.hasClass(d.classSlide)){if(w.is("a"))return;e=h.index(w)}V(e);b.slide.is(b.slideNext)||(n=!0,x(),((e=I?I.call(b,a):!0)||"undefined"===typeof e)&&u(B(f),d.isCarousel?d.time:
	0,function(){O(a)}))}a?w.is(b.slide)||a.preventDefault():k()}function u(a,c,e,f){null===a&&(a=B(b.index));c=c||0;if(W&&d.isCarousel){f=f||0;if(c&&e)l.one(m.toLowerCase()+"TransitionEnd transitionend",e);q[m+"Transition"]=c?c/1E3+"s":"";q[m+"Transform"]="translateX("+-1*(r(a,!0)-f)+"%)";!c&&e&&e()}else l.stop(!0,!0).animate({left:r(a)+"%"},c,e)}function O(a){b.slide=b.slideNext;n=!1;h.removeClass(d.classActive);b.slide.addClass(d.classActive);q[m+"Transition"]="";d.canLoop&&P();Q();a&&("click"===a.type&&
	b.slide.focus(),H&&H.call(b,a))}function V(a){var c=b.index,e=f-1;"undefined"!==typeof a?(p=a<c?!0:!1,c=a):p?(c-=d.step,c=0>=c?d.canLoop?y(c):0:c):(c+=d.step,c=c>=e?d.canLoop?y(c):e:c);b.slideNext=h.eq(c);b.index=c}function R(){return!d.canLoop&&(p&&0===b.index||!p&&b.index===f-1)}function S(a){s&&(a?g(a,{slide:C.index(this)}):C.removeAttr("class").eq(b.index).addClass(d.classActive))}function Q(){var a,c=d.classDisabled;if(!d.canLoop){z.removeClass(c);switch(b.index){case 0:a=D;break;case f-1:a=
	E}a&&a.addClass(c)}S()}function r(a,b){return b?100/f*a:-100*a}function y(a){a>=f&&(a-=f);0>a&&(a=f+a);return a}function B(a){return y(b.index+(d.canLoop?A-a:0))}function T(a){return y(d.canLoop?a-A+b.index:a)}function P(){for(var a=f,c,e,g;a--;)c=h.eq(T(a)),e=c.data("x"),g=r(a,!0)+"%",g!==e&&c.css({left:g,display:d.display}).attr("tabindex","-1").data("x",g);u(d.canLoop?A:b.index)}function X(){var a,c;function h(e){var g=e.originalEvent,v=g.touches&&g.touches[0]||g;1<v.length||g.scale&&1!==g.scale||
	(a=(v.pageX||v.screenX)-k.x,c=(v.pageY||v.screenY)-k.y,"undefined"===typeof t&&(t=!!(t||Math.abs(a)<Math.abs(c))),t||(e.preventDefault(),x(),p=0<a,n=!0,!d.canLoop&&R()&&(a/=Math.abs(a)/b.width+1),u(null,null,null,a/b.width*(100/f))))}function l(){if(!t){var c=+new Date-k.time,f=Math.abs(a),c=250>c&&20<f||f>b.width/3;n=!1;c&&!R()?g(event,{isPrev:p}):0<f&&u(null,d.time)}e.off(q,h);e.off(r,l)}function m(a){F&&clearTimeout(F);F=setTimeout(function(){b.width=e.outerWidth()},a?300:0)}var k,q="touchmove MSPointerMove",
	r="touchend touchleave touchcancel MSPointerUp MSPointerOut";d.isCarousel=!0;e.on("touchstart MSPointerDown",function(b){var d=z||s&&s.add(z),f=b.originalEvent,f=f.touches&&f.touches[0]||f;d.has(b.target).length||d.is(b.target)||(n&&O(),k={x:f.pageX||f.screenX,y:f.pageY||f.screenY,time:+new Date},t=c=a=void 0,e.on(q,h),e.on(r,l))}).on("click",function(a){!t&&n&&a.preventDefault()}).addClass(d.classTouch);m();$(window).resize(m)}var b=this,G=["ms","O","Moz","Webkit",""],m="",q,d={next:"button.next",
	previous:"button.previous",classStrip:"strip",classSlide:"slide",classActive:"sticky",classMarkers:"markers",classDisabled:"disabled",classTouch:"touch",step:1,delay:3E3,interval:5E3,time:400,display:"block",canLoop:!1,isManual:!0,isCarousel:!0},e,h,l,s,C,z,D,E,L,K,F,f,A,n,t,p,W=function(){for(var a=document.body.style,b=G.length;b--;)if("string"===typeof a[G[b]+"Transition"]){m=G[b];break}return!!m}(),Y="ontouchstart"in window||navigator.msPointerEnabled||window.DocumentTouch&&document instanceof
	DocumentTouch;J(U||{});b.init=function(){e=$(d.slideshow);h=e.find("."+d.classSlide);l=e.find("."+d.classStrip);f=h.length;if(e.length&&!(2>f)){q=l[0].style;b.slide=h.filter("."+d.classActive);b.index=h.index(b.slide);b.slide.length||(b.index=0,b.slide=h.eq(b.index));A=d.canLoop?Math.floor((f-1)/2):0;l.width(100*f+"%");h.width(100/f+"%");Y&&X();h.on("click touchend",g);e.mouseenter(x).mouseleave(k);E=e.find(d.next).on("click touchend",M);D=e.find(d.previous).on("click touchend",N);z=D.add(E);L=setTimeout(k,
	d.delay);if(d.classMarkers){s=$("<div />").addClass(d.classMarkers).on("click touchend","button",S);for(var a=f;a--;)s.prepend($("<button>"+(a+1)+"</button>"));C=s.find("button");e.append(s)}Q();P();b.element=e;b.strip=l;b.slides=h;e.removeClass(d.classDisabled)}};b.start=k;b.stop=x;b.next=M;b.prev=N;b.change=g;b.transition=u;b.getTransitionX=r;b.getIndexOffset=B;b.getPositionOffset=T;b.updateConfig=J};