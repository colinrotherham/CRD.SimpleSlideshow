/*
	Copyright (c) 2012 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};
	CRD.Slideshow=function(N,D){function v(){b.isManual||(E=setTimeout(function(){j()},b.interval))}function w(){clearTimeout(F);clearTimeout(E)}function G(a){j(a,{isPrev:!1})}function H(a){j(a,{isPrev:!0})}function j(c,m){var f=$(this),g=m&&m.slide;h=!(!m||!m.isPrev);if(!x&&(!c||c&&!f.hasClass(b.classDisabled))){if(f.hasClass(b.classSlide)){if(f.is("a"))return;g=d.index(f)}var f=g,g=a.slide,j=b.classSlide,k=a.number,n=d.length;"undefined"!==typeof f?(g=d.eq(f),k=f+1):(g=h?g.prev("."+j):g.next("."+j),
	k=h?k-1:k+1,g.length||(b.canLoop||(h=!h),g=h?d.eq(n-1):d.eq(0),k=h?n:1));a.slideNext=g;a.number=k;a.slide.is(a.slideNext)||(x=!0,w(),I(),t(b.isCarousel?b.time:0,function(){d.removeClass(b.classActive);a.slideNext.addClass(b.classActive);a.slide=a.slideNext;x=!1;y[l+"Transition"]="";c&&"click"===c.type&&a.slide.focus();D&&D.call(a)}))}c?e.is(a.slide)||c.preventDefault():v()}function t(c,e,f){if(h&&a.number===d.length||!h&&1===a.number)c*=1.5;if(J&&b.isCarousel){f=f||0;if(e)q.one(l.toLowerCase()+"TransitionEnd transitionend",
	e);y[l+"Transition"]=c?c/1E3+"s":"";y[l+"Transform"]="translateX("+-1*(z(null,!0)-f)+"%)"}else q.animate({left:z()+"%"},c,e)}function z(c,b){c=0===c||c?c:a.number-1;return b?c*(100/d.length):-100*c}function K(c){r&&(c?j(c,{slide:A.index(this)}):A.removeAttr("class").eq(a.number-1).addClass(b.classActive))}function I(){if(!b.canLoop)switch(a.prev.add(a.next).removeClass(b.classDisabled),a.number){case 1:a.prev.addClass(b.classDisabled);break;case d.length:a.next.addClass(b.classDisabled)}K()}function L(c){B&&
	clearTimeout(B);B=setTimeout(function(){a.width=e.outerWidth()},c?300:0)}for(var a=this,u=["ms","O","Moz","Webkit",""],l=u[u.length],y,b={next:"button.next",previous:"button.previous",classStrip:"strip",classSlide:"slide",classActive:"sticky",classMarkers:"markers",classDisabled:"disabled",delay:3E3,interval:5E3,time:400,canLoop:!0,isManual:!0,isCarousel:!0},e,d,q,r,A,F,E,B,x,h,J,O=document.body.style,C=u.length;C--;)if("string"===typeof O[u[C]+"Transition"]){l=u[C];break}J=!!l;var M="ontouchstart"in
	window||window.DocumentTouch&&document instanceof DocumentTouch;$.each(N,function(a,d){b[a]=d});a.element=e;a.strip=q;a.slides=d;a.init=function(){e=$(b.slideshow);d=e.find("."+b.classSlide);q=e.find("."+b.classStrip);if(e.length&&!(2>d.length)){y=q[0].style;a.slide=d.filter("."+b.classActive);a.number=d.index(a.slide)+1;a.slide.length||(a.number=1,a.slide=d.eq(a.number-1).addClass(b.classActive));M&&(b.isCarousel=!0);q.width(100*d.length+"%");d.width(100/d.length+"%");for(var c=d.length,m;c--;)m=
	z(c,!0)+"%",d.eq(c).css({left:m,display:"block"}).attr("tabindex","-1");t(0);e.mouseenter(w).mouseleave(v);if(M){var f,g,l=function(b){var c=b.originalEvent,e=c.touches[0];if(!(1<e.length||c.scale&&1!==c.scale))if(f=e.pageX-n.x,g=e.pageY-n.y,"undefined"===typeof p&&(p=!!(p||Math.abs(f)<Math.abs(g))),!p){b.preventDefault();w();if((h=0<f)&&1===a.number||!h&&a.number===d.length)f/=Math.abs(f)/a.width+1;t(0,void 0,f/a.width*(100/d.length))}},k=function(){p||(250>+new Date-n.time&&20<Math.abs(f)||Math.abs(f)>
	a.width/3?j(void 0,{isPrev:h}):t(b.time));e.off("touchmove",s);e.off("touchend touchcancel",s)},n,p,s="."+b.classStrip;e.on("touchstart",s,function(a){x||(a=a.originalEvent.touches[0],n={x:a.pageX,y:a.pageY,time:+new Date},p=g=f=void 0,e.on("touchmove",s,l),e.on("touchend touchcancel",s,k))});e.on("click",s,function(a){p||a.preventDefault()});$(window).resize(L)}else d.click(j),a.next=e.find(b.next).on("click",G).show(),a.prev=e.find(b.previous).on("click",H).show();if(b.classMarkers){r=$("<ul />").addClass(b.classMarkers);
	for(c=d.length;c--;)r.prepend($('<li><a href="#" role="button">'+(c+1)+"</a></li>"));A=r.find("a").click(K);e.append(r);r.show()}I();L();F=setTimeout(v,b.delay)}};a.start=v;a.stop=w;a.next=G;a.prev=H;a.transition=t;a.getTransitionX=z};