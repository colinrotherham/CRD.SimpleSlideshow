/*
	Copyright (c) 2012 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};CRD.Slideshow=function(j,f){var m=this,t=["o","ms","Moz","webkit",""],r=t[0],w={next:"button.next",previous:"button.previous",classStrip:"strip",classSlide:"slide",classActive:"sticky",classMarkers:"markers",classDisabled:"disabled",delay:3000,interval:5000,time:600,canLoop:true,isManual:false,isCarousel:true,isCSS:(function(){var A=document.body.style,z=t.length;while(z--){if(typeof A[t[z]+"Transition"]==="string"){r=t[z]}}return !!r})()},u,b,h,a,x=false,q=false;$.each(j,function(z,A){w[z]=A});function s(){var z=$(w.slideshow);m.strip=z.find("."+w.classStrip);m.slides=z.find("."+w.classSlide);if(!z.length||m.slides.length<2){return}m.next=z.find(w.next).show();m.previous=z.find(w.previous).show();m.strip.width((m.slides.length*100)+"%");m.slides.width((100/m.slides.length)+"%");m.slide=m.slides.filter("."+w.classActive);m.slideNumber=m.slides.index(m.slide)+1;if(!m.slide.length){m.slideNumber=1;m.slide=m.slides.eq(m.slideNumber-1).addClass(w.classActive)}m.element=z;o();n();i();y();h=setTimeout(e,w.delay)}function e(){if(!w.isManual){a=setTimeout(function(){k()},w.interval)}}function p(){clearTimeout(h);clearTimeout(a)}function k(B,A){q=!!(B&&B.data&&B.data.isBack);var z=$(this);if(!x&&(!B||B&&!z.hasClass(w.classDisabled))){if(z.hasClass(w.classSlide)){if(z.is("a")){return}A=m.slides.index(z)}d(A);if(!m.slide.is(m.slideNext)){x=true;o();l();v((w.isCarousel)?w.time:0,function(){g(B)});p()}}if(!B){e()}else{B.preventDefault()}}function v(A,z){m.strip.animate({left:c()+"%"},(w.isCSS)?0:A);if(z){setTimeout(z,A)}}function g(z){m.slides.removeClass(w.classActive);m.slideNext.addClass(w.classActive);m.slide=m.slideNext;x=false;if(z&&z.type==="click"){m.slide.focus()}if(f){f.call(m)}}function c(A,z){A=(typeof A!=="undefined")?A:m.slideNumber-1;return(z)?A*(100/m.slides.length):A*-100}function d(B){var z=m.slide,C=m.slides,A=w.classSlide,E=m.slideNumber,D=C.length;if(typeof B!=="undefined"){z=C.eq(B);E=B+1}else{z=(q)?z.prev("."+A):z.next("."+A);E=(q)?E-1:E+1;if(!z.length){if(!w.canLoop){q=!q}z=(q)?C.eq(D-1):C.eq(0);E=(q)?D:1}}m.slideNext=z;m.slideNumber=E}function l(A){if(u){var z=m.slideNumber-1;if(A){k(A,b.index(this))}else{b.removeAttr("class").eq(z).addClass(w.classActive)}}}function o(){if(!w.canLoop){m.previous.add(m.next).removeClass(w.classDisabled);switch(m.slideNumber){case 1:m.previous.addClass(w.classDisabled);break;case m.slides.length:m.next.addClass(w.classDisabled);break}}}function n(){var B=m.slides.length,z;while(B--){z=c(B,true)+"%";m.slides.eq(B).css({left:z,display:"block"}).attr("tabindex","-1")}v(0);if(w.isCSS){var A=m.strip.get(0).style;var C="left "+w.time/1000+"s";setTimeout(function(){A[r+"Transition"]=C},0)}}function y(){if(w.classMarkers){u=$("<ul />").addClass(w.classMarkers);var z=m.slides.length;while(z--){u.prepend($('<li><a href="#" role="button">'+(z+1)+"</a></li>"))}b=u.find("a").click(l);m.element.append(u);l();u.show()}}function i(){m.next.on("click",{isBack:false},k);m.previous.on("click",{isBack:true},k);m.slides.click(k);m.element.mouseenter(p).mouseleave(e)}m.init=s;m.start=e;m.stop=p;m.change=k;m.transition=v;m.getTransitionX=c};