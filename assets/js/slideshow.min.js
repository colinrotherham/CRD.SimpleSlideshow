/*
	Copyright (c) 2012 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};
	CRD.Slideshow=function(Q,F){function w(){b.isManual||(G=setTimeout(function(){q()},b.interval))}function x(){clearTimeout(H);clearTimeout(G)}function I(c){q(c,{isPrev:!1})}function J(c){q(c,{isPrev:!0})}function q(c,j){var d=$(this),f=j&&j.slide;if(!r){k=j&&j.isPrev;if(d.hasClass(b.classSlide)){if(d.is("a"))return;f=g.index(d)}var e=a.number;"undefined"!==typeof f?(k=f<e?!0:!1,e=f+1):e=k?1===e?b.canLoop?h:1:e-1:e===h?b.canLoop?1:h:e+1;a.slideNext=g.eq(e-1);a.number=e;a.slide.is(a.slideNext)||(r=!0,
	x(),v(b.isCarousel?b.time:0,function(){K(c)}))}c?d.is(a.slide)||c.preventDefault():w()}function v(c,j,d){var f;if(b.canLoop&&c){f=a.number;var e,m;!k&&1===f?(f=h+1,e=g.eq(0)):k&&f===h&&(f=0,e=g.eq(h-1));e&&(m=n(f-1,!0),e.css("left",m+"%").data("x",m),z=!0)}else f=a.number;if(L&&b.isCarousel){d=d||0;if(j)t.one(l.toLowerCase()+"TransitionEnd transitionend",j);y[l+"Transition"]=c?c/1E3+"s":"";y[l+"Transform"]="translateX("+-1*(n(f-1,!0)-d)+"%)"}else t.stop(!0,!0).animate({left:n(f-1)+"%"},c,j)}function K(c){a.slide=
	a.slideNext;r=!1;g.removeClass(b.classActive);a.slide.addClass(b.classActive);y[l+"Transition"]="";b.canLoop&&z&&(z=!1,M());N();c&&"click"===c.type&&a.slide.focus();F&&F.call(a)}function n(c,a){return a?c*(100/h):-100*c}function O(c){u&&(c?q(c,{slide:A.index(this)}):A.removeAttr("class").eq(a.number-1).addClass(b.classActive))}function N(){var c,d=b.classDisabled;if(!b.canLoop){P.removeClass(d);switch(a.number){case 1:c=B;break;case h:c=C}c&&c.addClass(d)}O()}function M(){for(var a=h,b,d,f;a--;)f=
	g.eq(a),b=f.data("x"),d=n(a,!0)+"%",d!==b&&(b=d,f.css({left:b,display:"block"}).attr("tabindex","-1").data("x",b));v(0)}for(var a=this,p=["ms","O","Moz","Webkit",""],l=p[p.length],y,b={next:"button.next",previous:"button.previous",classStrip:"strip",classSlide:"slide",classActive:"sticky",classMarkers:"markers",classDisabled:"disabled",classTouch:"touch",delay:3E3,interval:5E3,time:400,canLoop:!0,isManual:!1,isCarousel:!0},d,g,t,u,A,P,B,C,H,G,D,r,z,s,k,h,L,R=document.body.style,E=p.length;E--;)if("string"===
	typeof R[p[E]+"Transition"]){l=p[E];break}L=!!l;var S="ontouchstart"in window||navigator.msPointerEnabled||window.DocumentTouch&&document instanceof DocumentTouch;$.each(Q,function(a,d){b[a]=d});a.element=d;a.strip=t;a.slides=g;a.init=function(){var c,j;d=$(b.slideshow);g=d.find("."+b.classSlide);t=d.find("."+b.classStrip);h=g.length;if(d.length&&!(2>h)){y=t[0].style;a.slide=g.filter("."+b.classActive);a.number=g.index(a.slide)+1;a.slide.length||(a.number=1,a.slide=g.eq(a.number-1).addClass(b.classActive));
	t.width(100*h+"%");g.width(100/h+"%");if(S){var l=function(d){var f=d.originalEvent,e=f.touches&&f.touches[0]||f;1<e.length||f.scale&&1!==f.scale||(c=(e.pageX||e.screenX)-m.x,j=(e.pageY||e.screenY)-m.y,"undefined"===typeof s&&(s=!!(s||Math.abs(c)<Math.abs(j))),s||(d.preventDefault(),x(),k=0<c,r=!0,!b.canLoop&&(k&&1===a.number||!k&&a.number===h)&&(c/=Math.abs(c)/a.width+1),v(0,void 0,c/a.width*(100/h))))},f=function(){if(!s){var e=+new Date-m.time,g=Math.abs(c),e=250>e&&20<g||g>a.width/3;r=!1;e&&!(k&&
	1===a.number||!k&&a.number===h)?q(void 0,{isPrev:k}):0<g&&v(b.time)}d.off(n,l);d.off(p,f)},e=function(b){D&&clearTimeout(D);D=setTimeout(function(){a.width=d.outerWidth()},b?300:0)},m,n="touchmove MSPointerMove",p="touchend touchleave touchcancel MSPointerUp MSPointerOut";b.isCarousel=!0;b.canLoop=!1;d.on("touchstart MSPointerDown",function(a){var b=a.originalEvent,b=b.touches&&b.touches[0]||b;u.has(a.target).length||(r&&K(),m={x:b.pageX||b.screenX,y:b.pageY||b.screenY,time:+new Date},s=j=c=void 0,
	d.on(n,l),d.on(p,f))}).on("click",function(a){!s&&r&&a.preventDefault()}).addClass(b.classTouch);e();$(window).resize(e)}g.on("click touchend",q);d.mouseenter(x).mouseleave(w);C=d.find(b.next).on("click touchend",I);B=d.find(b.previous).on("click touchend",J);P=B.add(C);H=setTimeout(w,b.delay);if(b.classMarkers){u=$("<div />").addClass(b.classMarkers).on("click touchend","button",O);for(e=h;e--;)u.prepend($("<button>"+(e+1)+"</button>"));A=u.find("button");d.append(u)}N();M()}};a.start=w;a.stop=x;
	a.change=q;a.next=I;a.prev=J;a.transition=v;a.getTransitionX=n};