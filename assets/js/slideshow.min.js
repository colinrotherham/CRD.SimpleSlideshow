/*
	Copyright (c) 2012 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};CRD.Slideshow=function(H,A){function r(){c.isManual||(B=setTimeout(function(){h()},c.interval))}function v(){clearTimeout(C);clearTimeout(B)}function h(b,d){g=!(!b||!b.data||!b.data.isBack);var e=$(this);if(!w&&(!b||b&&!e.hasClass(c.classDisabled))){if(e.hasClass(c.classSlide)){if(e.is("a"))return;d=a.slides.index(e)}var e=d,f=a.slide,m=a.slides,h=c.classSlide,j=a.number,l=m.length;"undefined"!==typeof e?(f=m.eq(e),j=e+1):(f=g?f.prev("."+h):f.next("."+h),j=g?j-1:j+1,f.length||(c.canLoop||(g=!g),f=g?m.eq(l-1):m.eq(0),j=g?l:1));a.slideNext=f;a.number=j;a.slide.is(a.slideNext)||(w=!0,D(),x(c.isCarousel?c.time:0,function(){a.slides.removeClass(c.classActive);a.slideNext.addClass(c.classActive);a.slide=a.slideNext;w=!1;s[k+"Transition"]="";b&&"click"===b.type&&a.slide.focus();A&&A.call(a)}),v())}b?b.preventDefault():r()}function x(b,c){E?(s[k+"Transition"]=b?b/1E3+"s":"",s[k+"Transform"]="translateX(-"+t(null,!0)+"%)"):a.strip.animate({left:t()+"%"},b);c&&setTimeout(c,b)}function t(b,c){b=0===b||b?b:a.number-1;return c?b*(100/a.slides.length):-100*b}function F(b){l&&(b?h(b,y.index(this)):y.removeAttr("class").eq(a.number-1).addClass(c.classActive))}function D(){if(!c.canLoop)switch(a.previous.add(a.next).removeClass(c.classDisabled),a.number){case 1:a.previous.addClass(c.classDisabled);break;case a.slides.length:a.next.addClass(c.classDisabled)}F()}for(var a=this,u=["ms","O","Moz","Webkit",""],k=u[0],c={next:"button.next",previous:"button.previous",classStrip:"strip",classSlide:"slide",classActive:"sticky",classMarkers:"markers",classDisabled:"disabled",delay:3E3,interval:5E3,time:600,canLoop:!0,isManual:!0,isCarousel:!0},l,y,C,B,s,w,g,E,I=document.body.style,z=u.length;z--;)"string"===typeof I[u[z]+"Transition"]&&(k=u[z]);E=!!k;var G="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;$.each(H,function(a,d){c[a]=d});a.init=function(){var b=$(c.slideshow),d=b.find("."+c.classSlide),e=b.find("."+c.classStrip);if(b.length&&!(2>d.length)){a.slide=d.filter("."+c.classActive);a.number=d.index(a.slide)+1;a.slide.length||(a.number=1,a.slide=d.eq(a.number-1).addClass(c.classActive));a.element=b;a.strip=e;a.slides=d;G||(a.next=b.find(c.next).show(),a.previous=b.find(c.previous).show());s=e[0].style;a.strip.width(100*a.slides.length+"%");a.slides.width(100/a.slides.length+"%");for(b=a.slides.length;b--;)d=t(b,!0)+"%",a.slides.eq(b).css({left:d,display:"block"}).attr("tabindex","-1");x(0);a.element.mouseenter(v).mouseleave(r);if(G){var f,m,g=function(a){var b=a.originalEvent,c=b.touches[0];1<c.length||b.scale&&1!==b.scale||(f=c.pageX-k.x,m=c.pageY-k.y,"undefined"===typeof n&&(n=!!(n||Math.abs(f)<Math.abs(m))),n||a.preventDefault())},j=function(){p.off("touchmove",q,g);p.off("touchend",q,j)},k,n,p=a.element,q="."+c.classStrip;p.on("touchstart",q,function(a){a=a.originalEvent.touches[0];k={x:a.pageX,y:a.pageY,time:+new Date};n=m=f=void 0;p.on("touchmove",q,g);p.on("touchend",q,j)})}else a.slides.click(h),a.next.on("click",{isBack:!1},h),a.previous.on("click",{isBack:!0},h);if(c.classMarkers){l=$("<ul />").addClass(c.classMarkers);for(b=a.slides.length;b--;)l.prepend($('<li><a href="#" role="button">'+(b+1)+"</a></li>"));y=l.find("a").click(F);a.element.append(l);l.show()}D();C=setTimeout(r,c.delay)}};a.start=r;a.stop=v;a.change=h;a.transition=x;a.getTransitionX=t};