/*
	Copyright (c) 2012 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};
	CRD.Slideshow=function(Q,F){function u(){a.isManual||(G=setTimeout(function(){k()},a.interval))}function v(){clearTimeout(H);clearTimeout(G)}function I(b){k(b,{isPrev:!1})}function J(b){k(b,{isPrev:!0})}function k(e,c){var f=$(this),n=c&&c.slide;g=!(!c||!c.isPrev);if(!s&&(!e||e&&!f.hasClass(a.classDisabled))){if(f.hasClass(a.classSlide)){if(f.is("a"))return;n=d.index(f)}var l=b.slide,k=a.classSlide,h=b.number,j=d.length;"undefined"!==typeof n?(l=d.eq(n),h=n+1):(l=g?l.prev("."+k):l.next("."+k),h=g?
	h-1:h+1,l.length||(a.canLoop||(g=!g),l=g?d.eq(j-1):d.eq(0),h=g?j:1));b.slideNext=l;b.number=h;b.slide.is(b.slideNext)||(s=!0,v(),K(),t(a.isCarousel?a.time:0,function(){L(e)}))}e?f.is(b.slide)||e.preventDefault():u()}function t(b,d,c){if(M&&a.isCarousel){c=c||0;if(d)q.one(m.toLowerCase()+"TransitionEnd transitionend",d);w[m+"Transition"]=b?b/1E3+"s":"";w[m+"Transform"]="translateX("+-1*(x(null,!0)-c)+"%)"}else q.animate({left:x()+"%"},b,d)}function L(e){d.removeClass(a.classActive);b.slideNext.addClass(a.classActive);
	b.slide=b.slideNext;s=!1;w[m+"Transition"]="";e&&"click"===e.type&&b.slide.focus();y();F&&F.call(b)}function x(a,c){a=0===a||a?a:b.number-1;return c?a*(100/d.length):-100*a}function N(){return g&&1===b.number||!g&&b.number===d.length}function y(c){r&&(c?k(c,{slide:z.index(this)}):z.removeAttr("class").eq(b.number-1).addClass(a.classActive))}function K(){if(!a.canLoop&&!A)switch(O.removeClass(a.classDisabled),b.number){case 1:B.addClass(a.classDisabled);break;case d.length:C.addClass(a.classDisabled)}}
	function P(a){D&&clearTimeout(D);D=setTimeout(function(){b.width=c.outerWidth()},a?300:0)}for(var b=this,p=["ms","O","Moz","Webkit",""],m=p[p.length],w,a={next:"button.next",previous:"button.previous",classStrip:"strip",classSlide:"slide",classActive:"sticky",classMarkers:"markers",classDisabled:"disabled",classTouch:"touch",delay:3E3,interval:5E3,time:400,canLoop:!0,isManual:!1,isCarousel:!0},c,d,q,r,z,O,B,C,H,G,D,s,g,M,R=document.body.style,E=p.length;E--;)if("string"===typeof R[p[E]+"Transition"]){m=
	p[E];break}M=!!m;var A="ontouchstart"in window||navigator.msPointerEnabled||window.DocumentTouch&&document instanceof DocumentTouch;$.each(Q,function(b,c){a[b]=c});b.element=c;b.strip=q;b.slides=d;b.init=function(){c=$(a.slideshow);d=c.find("."+a.classSlide);q=c.find("."+a.classStrip);if(c.length&&!(2>d.length)){w=q[0].style;b.slide=d.filter("."+a.classActive);b.number=d.index(b.slide)+1;b.slide.length||(b.number=1,b.slide=d.eq(b.number-1).addClass(a.classActive));A&&(a.canLoop=!1,a.isCarousel=!0,
	c.addClass(a.classTouch));q.width(100*d.length+"%");d.width(100/d.length+"%");for(var e=d.length,m;e--;)m=x(e,!0)+"%",d.eq(e).css({left:m,display:"block"}).attr("tabindex","-1");t(0);c.mouseenter(v).mouseleave(u);if(A){var f,n,l=function(a){var c=a.originalEvent,e=c.touches&&c.touches[0]||c;1<e.length||c.scale&&1!==c.scale||(f=(e.pageX||e.screenX)-h.x,n=(e.pageY||e.screenY)-h.y,"undefined"===typeof j&&(j=!!(j||Math.abs(f)<Math.abs(n))),j||(a.preventDefault(),v(),g=0<f,N()&&(f/=Math.abs(f)/b.width+
	1),t(0,void 0,f/b.width*(100/d.length))))},p=function(){j||((250>+new Date-h.time&&20<Math.abs(f)||Math.abs(f)>b.width/3)&&!N()?k(void 0,{isPrev:g}):t(a.time));c.off("touchmove MSPointerMove");c.off("touchend touchcancel MSPointerUp MSPointerOut")},h,j;c.on("touchstart MSPointerDown",function(b){var a=b.originalEvent,a=a.touches&&a.touches[0]||a;r.has(b.target).length||(s&&L(),h={x:a.pageX||a.screenX,y:a.pageY||a.screenY,time:+new Date},j=n=f=void 0,c.on("touchmove MSPointerMove",l),c.on("touchend touchcancel MSPointerUp MSPointerOut",
	p))});c.on("click",function(a){!j&&s&&a.preventDefault()});$(window).resize(P)}else d.click(k),C=c.find(a.next).on("click",I),B=c.find(a.previous).on("click",J),O=B.add(C).css("display","block");if(a.classMarkers){r=$("<div />").addClass(a.classMarkers).on("click touchend","button",y);for(e=d.length;e--;)r.prepend($("<button>"+(e+1)+"</button>"));z=r.find("button");c.append(r)}K();y();P();H=setTimeout(u,a.delay)}};b.start=u;b.stop=v;b.next=I;b.prev=J;b.transition=t;b.getTransitionX=x};