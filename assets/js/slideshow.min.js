/*
	Copyright (c) 2012 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};CRD.Slideshow=function(J,B){function r(){c.isManual||(C=setTimeout(function(){h()},c.interval))}function w(){clearTimeout(D);clearTimeout(C)}function h(b,e){g=!(!b||!b.data||!b.data.isBack);var d=$(this);if(!x&&(!b||b&&!d.hasClass(c.classDisabled))){if(d.hasClass(c.classSlide)){if(d.is("a"))return;e=a.slides.index(d)}var d=e,f=a.slide,m=a.slides,h=c.classSlide,j=a.number,l=m.length;"undefined"!==typeof d?(f=m.eq(d),j=d+1):(f=g?f.prev("."+h):f.next("."+h),j=g?j-1:j+1,f.length||(c.canLoop||(g=!g),f=g?m.eq(l-1):m.eq(0),j=g?l:1));a.slideNext=f;a.number=j;a.slide.is(a.slideNext)||(x=!0,E(),s(c.isCarousel?c.time:0,function(){a.slides.removeClass(c.classActive);a.slideNext.addClass(c.classActive);a.slide=a.slideNext;x=!1;t[k+"Transition"]="";b&&"click"===b.type&&a.slide.focus();B&&B.call(a)}),w())}b?b.preventDefault():r()}function s(b,c,d){F?(t[k+"Transition"]=b?b/1E3+"s":"",t[k+"Transform"]="translateX("+-1*(u(null,!0)-(d||0))+"%)"):a.strip.animate({left:u()+"%"},b);c&&setTimeout(c,b)}function u(b,c){b=0===b||b?b:a.number-1;return c?b*(100/a.slides.length):-100*b}function G(b){l&&(b?h(b,y.index(this)):y.removeAttr("class").eq(a.number-1).addClass(c.classActive))}function E(){if(!c.canLoop)switch(a.previous.add(a.next).removeClass(c.classDisabled),a.number){case 1:a.previous.addClass(c.classDisabled);break;case a.slides.length:a.next.addClass(c.classDisabled)}G()}function H(b){z&&clearTimeout(z);z=setTimeout(function(){a.width=a.element.outerWidth()},b?300:0)}for(var a=this,v=["ms","O","Moz","Webkit",""],k=v[0],c={next:"button.next",previous:"button.previous",classStrip:"strip",classSlide:"slide",classActive:"sticky",classMarkers:"markers",classDisabled:"disabled",delay:3E3,interval:5E3,time:600,canLoop:!0,isManual:!0,isCarousel:!0},l,y,D,C,z,t,x,g,F,K=document.body.style,A=v.length;A--;)"string"===typeof K[v[A]+"Transition"]&&(k=v[A]);F=!!k;var I="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;$.each(J,function(a,e){c[a]=e});a.init=function(){var b=$(c.slideshow),e=b.find("."+c.classSlide),d=b.find("."+c.classStrip);if(b.length&&!(2>e.length)){a.slide=e.filter("."+c.classActive);a.number=e.index(a.slide)+1;a.slide.length||(a.number=1,a.slide=e.eq(a.number-1).addClass(c.classActive));a.element=b;a.strip=d;a.slides=e;I||(a.next=b.find(c.next).show(),a.previous=b.find(c.previous).show());t=d[0].style;a.strip.width(100*a.slides.length+"%");a.slides.width(100/a.slides.length+"%");for(b=a.slides.length;b--;)e=u(b,!0)+"%",a.slides.eq(b).css({left:e,display:"block"}).attr("tabindex","-1");s(0);a.element.mouseenter(w).mouseleave(r);if(I){var f,m,g=function(b){var c=b.originalEvent,d=c.touches[0];1<d.length||c.scale&&1!==c.scale||(f=d.pageX-k.x,m=d.pageY-k.y,"undefined"===typeof n&&(n=!!(n||Math.abs(f)<Math.abs(m))),n||b.preventDefault(),s(0,function(){},f/a.width*(100/a.slides.length)))},j=function(){p.off("touchmove",q,g);p.off("touchend",q,j)},k,n,p=a.element,q="."+c.classStrip;p.on("touchstart",q,function(a){a=a.originalEvent.touches[0];k={x:a.pageX,y:a.pageY,time:+new Date};n=m=f=void 0;p.on("touchmove",q,g);p.on("touchend",q,j)});$(window).resize(H)}else a.slides.click(h),a.next.on("click",{isBack:!1},h),a.previous.on("click",{isBack:!0},h);if(c.classMarkers){l=$("<ul />").addClass(c.classMarkers);for(b=a.slides.length;b--;)l.prepend($('<li><a href="#" role="button">'+(b+1)+"</a></li>"));y=l.find("a").click(G);a.element.append(l);l.show()}E();H();D=setTimeout(r,c.delay)}};a.start=r;a.stop=w;a.change=h;a.transition=s;a.getTransitionX=u};