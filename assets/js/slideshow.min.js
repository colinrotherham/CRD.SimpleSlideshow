/*
	Copyright (c) 2012 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};CRD.Slideshow=function(I,A){function r(){c.isManual||(B=setTimeout(function(){j()},c.interval))}function v(){clearTimeout(C);clearTimeout(B)}function j(b,e){h=!(!b||!b.data||!b.data.isBack);var d=$(this);if(!w&&(!b||b&&!d.hasClass(c.classDisabled))){if(d.hasClass(c.classSlide)){if(d.is("a"))return;e=a.slides.index(d)}var d=e,f=a.slide,n=a.slides,j=c.classSlide,k=a.number,m=n.length;"undefined"!==typeof d?(f=n.eq(d),k=d+1):(f=h?f.prev("."+j):f.next("."+j),k=h?k-1:k+1,f.length||(c.canLoop||(h=!h),f=h?n.eq(m-1):n.eq(0),k=h?m:1));a.slideNext=f;a.number=k;a.slide.is(a.slideNext)||(w=!0,D(),s(c.isCarousel?c.time:0,function(){a.slides.removeClass(c.classActive);a.slideNext.addClass(c.classActive);a.slide=a.slideNext;w=!1;t[l+"Transition"]="";b&&"click"===b.type&&a.slide.focus();A&&A.call(a)}),v())}b?b.preventDefault():r()}function s(b,c,d){E?(t[l+"Transition"]=b?b/1E3+"s":"",t[l+"Transform"]="translateX("+-1*(u(null,!0)-(d||0))+"%)"):a.strip.animate({left:u()+"%"},b);c&&setTimeout(c,b)}function u(b,c){b=0===b||b?b:a.number-1;return c?b*(100/a.slides.length):-100*b}function F(b){m&&(b?j(b,x.index(this)):x.removeAttr("class").eq(a.number-1).addClass(c.classActive))}function D(){if(!c.canLoop)switch(a.previous.add(a.next).removeClass(c.classDisabled),a.number){case 1:a.previous.addClass(c.classDisabled);break;case a.slides.length:a.next.addClass(c.classDisabled)}F()}function G(b){y&&clearTimeout(y);y=setTimeout(function(){a.width=a.element.outerWidth()},b?300:0)}for(var a=this,g=["ms","O","Moz","Webkit",""],l=g[g.length],c={next:"button.next",previous:"button.previous",classStrip:"strip",classSlide:"slide",classActive:"sticky",classMarkers:"markers",classDisabled:"disabled",delay:3E3,interval:5E3,time:600,canLoop:!0,isManual:!0,isCarousel:!0},m,x,C,B,y,t,w,h,E,J=document.body.style,z=g.length;z--;)"string"===typeof J[g[z]+"Transition"]&&(l=g[z]);E=!!l;var H="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;$.each(I,function(a,e){c[a]=e});a.init=function(){var b=$(c.slideshow),e=b.find("."+c.classSlide),d=b.find("."+c.classStrip);if(b.length&&!(2>e.length)){a.slide=e.filter("."+c.classActive);a.number=e.index(a.slide)+1;a.slide.length||(a.number=1,a.slide=e.eq(a.number-1).addClass(c.classActive));a.element=b;a.strip=d;a.slides=e;H||(a.next=b.find(c.next).show(),a.previous=b.find(c.previous).show());t=d[0].style;a.strip.width(100*a.slides.length+"%");a.slides.width(100/a.slides.length+"%");for(b=a.slides.length;b--;)e=u(b,!0)+"%",a.slides.eq(b).css({left:e,display:"block"}).attr("tabindex","-1");s(0);a.element.mouseenter(v).mouseleave(r);if(H){var f,n,h=function(b){var c=b.originalEvent,d=c.touches[0];1<d.length||c.scale&&1!==c.scale||(f=d.pageX-l.x,n=d.pageY-l.y,"undefined"===typeof g&&(g=!!(g||Math.abs(f)<Math.abs(n))),g||b.preventDefault(),s(0,function(){},f/a.width*(100/a.slides.length)))},k=function(){p.off("touchmove",q,h);p.off("touchend",q,k)},l,g,p=a.element,q="."+c.classStrip;p.on("touchstart",q,function(a){a=a.originalEvent.touches[0];l={x:a.pageX,y:a.pageY,time:+new Date};g=n=f=void 0;p.on("touchmove",q,h);p.on("touchend",q,k)});$(window).resize(G)}else a.slides.click(j),a.next.on("click",{isBack:!1},j),a.previous.on("click",{isBack:!0},j);if(c.classMarkers){m=$("<ul />").addClass(c.classMarkers);for(b=a.slides.length;b--;)m.prepend($('<li><a href="#" role="button">'+(b+1)+"</a></li>"));x=m.find("a").click(F);a.element.append(m);m.show()}D();G();C=setTimeout(r,c.delay)}};a.start=r;a.stop=v;a.change=j;a.transition=s;a.getTransitionX=u};