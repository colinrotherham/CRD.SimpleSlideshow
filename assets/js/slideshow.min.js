/*
	Copyright (c) 2012 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};
	CRD.Slideshow=function(T,I){function y(){c.isManual||(J=setTimeout(function(){g()},c.interval))}function z(){clearTimeout(K);clearTimeout(J)}function L(a){g(a,{isPrev:!1})}function M(a){g(a,{isPrev:!0})}function g(a,f){var e=$(this),j=f&&f.slide,g=b.index;if(!m){n=f&&f.isPrev;if(e.hasClass(c.classSlide)){if(e.is("a"))return;j=k.index(e)}var h=b.index;"undefined"!==typeof j?(n=j<h?!0:!1,h=j):h=n?0===h?c.canLoop?d-1:0:h-1:h===d-1?c.canLoop?0:d-1:h+1;b.slideNext=k.eq(h);b.index=h;b.slide.is(b.slideNext)||(m=
	!0,z(),v(r(b.index+(c.canLoop?w-g:0)),c.isCarousel?c.time:0,function(){N(a)}))}a?e.is(b.slide)||a.preventDefault():y()}function v(a,f,e,d){null===a&&(a=r(b.index+(c.canLoop?w-b.index:0)));f=f||0;if(O&&c.isCarousel){d=d||0;if(e)s.one(l.toLowerCase()+"TransitionEnd transitionend",e);A[l+"Transition"]=f?f/1E3+"s":"";A[l+"Transform"]="translateX("+-1*(p(a,!0)-d)+"%)"}else s.stop(!0,!0).animate({left:p(a)+"%"},f,e)}function N(a){b.slide=b.slideNext;m=!1;k.removeClass(c.classActive);b.slide.addClass(c.classActive);
	A[l+"Transition"]="";c.canLoop&&P();Q();a&&"click"===a.type&&b.slide.focus();I&&I.call(b)}function R(){return!c.canLoop&&(n&&0===b.index||!n&&b.index===d-1)}function S(a){t&&(a?g(a,{slide:B.index(this)}):B.removeAttr("class").eq(b.index).addClass(c.classActive))}function Q(){var a,f=c.classDisabled;if(!c.canLoop){C.removeClass(f);switch(b.index){case 0:a=D;break;case d-1:a=E}a&&a.addClass(f)}S()}function p(a,b){return b?a*(100/d):-100*a}function r(a){a>=d&&(a-=d);0>a&&(a=d+a);return a}function P(){for(var a=
	d,e,g,j;a--;)e=k.eq(r(c.canLoop?a-w+b.index:a)),g=e.data("x"),j=p(a,!0)+"%",j!==g&&e.css({left:j,display:"block"}).attr("tabindex","-1").data("x",j);v(c.canLoop?w:b.index)}for(var b=this,F=["ms","O","Moz","Webkit",""],l="",A,c={next:"button.next",previous:"button.previous",classStrip:"strip",classSlide:"slide",classActive:"sticky",classMarkers:"markers",classDisabled:"disabled",classTouch:"touch",delay:3E3,interval:5E3,time:400,canLoop:!1,isManual:!0,isCarousel:!0},e,k,s,t,B,C,D,E,K,J,G,d,w,m,q,n,
	O,U=document.body.style,H=F.length;H--;)if("string"===typeof U[F[H]+"Transition"]){l=F[H];break}O=!!l;var V="ontouchstart"in window||navigator.msPointerEnabled||window.DocumentTouch&&document instanceof DocumentTouch;$.each(T,function(a,b){c[a]=b});b.element=e;b.strip=s;b.slides=k;b.init=function(){var a,f;e=$(c.slideshow);k=e.find("."+c.classSlide);s=e.find("."+c.classStrip);d=k.length;if(e.length&&!(2>d)){A=s[0].style;b.slide=k.filter("."+c.classActive);b.index=k.index(b.slide);b.slide.length||
	(b.index=0,b.slide=k.eq(b.index));w=c.canLoop?Math.floor((d-1)/2):0;s.width(100*d+"%");k.width(100/d+"%");if(V){var l=function(e){var g=e.originalEvent,x=g.touches&&g.touches[0]||g;1<x.length||g.scale&&1!==g.scale||(a=(x.pageX||x.screenX)-h.x,f=(x.pageY||x.screenY)-h.y,"undefined"===typeof q&&(q=!!(q||Math.abs(a)<Math.abs(f))),q||(e.preventDefault(),z(),n=0<a,m=!0,!c.canLoop&&R()&&(a/=Math.abs(a)/b.width+1),v(null,null,null,a/b.width*(100/d))))},j=function(){if(!q){var d=+new Date-h.time,f=Math.abs(a),
	d=250>d&&20<f||f>b.width/3;m=!1;d&&!R()?g(void 0,{isPrev:n}):0<f&&v(null,c.time)}e.off(p,l);e.off(r,j)},u=function(a){G&&clearTimeout(G);G=setTimeout(function(){b.width=e.outerWidth()},a?300:0)},h,p="touchmove MSPointerMove",r="touchend touchleave touchcancel MSPointerUp MSPointerOut";c.isCarousel=!0;e.on("touchstart MSPointerDown",function(b){var c=t.add(C),d=b.originalEvent,d=d.touches&&d.touches[0]||d;!c.has(b.target).length&&!c.is(b.target)&&(m&&N(),h={x:d.pageX||d.screenX,y:d.pageY||d.screenY,
	time:+new Date},q=f=a=void 0,e.on(p,l),e.on(r,j))}).on("click",function(a){!q&&m&&a.preventDefault()}).addClass(c.classTouch);u();$(window).resize(u)}k.on("click touchend",g);e.mouseenter(z).mouseleave(y);E=e.find(c.next).on("click touchend",L);D=e.find(c.previous).on("click touchend",M);C=D.add(E);K=setTimeout(y,c.delay);if(c.classMarkers){t=$("<div />").addClass(c.classMarkers).on("click touchend","button",S);for(u=d;u--;)t.prepend($("<button>"+(u+1)+"</button>"));B=t.find("button");e.append(t)}Q();
	P()}};b.start=y;b.stop=z;b.change=g;b.next=L;b.prev=M;b.transition=v;b.getTransitionX=p};