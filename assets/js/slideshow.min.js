/*
	Copyright (c) 2012 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};
	CRD.Slideshow=function(V,H,I){function J(a){$.each(a,function(a,b){c[a]=b});K="undefined"!==typeof c.isTouch?!!c.isTouch:"ontouchstart"in window||navigator.msPointerEnabled||window.DocumentTouch&&document instanceof DocumentTouch}function n(){c.isManual||(L=setTimeout(function(){p()},c.interval))}function w(){clearTimeout(M);clearTimeout(L)}function N(a){p.call(this,a,{isPrev:!1})}function O(a){p.call(this,a,{isPrev:!0})}function p(a,e){var d=$(this),g=e&&e.slide,h=b.index;if(!q){r=e&&e.isPrev;if(d.hasClass(c.classSlide)){if(d.is("a"))return;
	g=f.index(d)}W.call(this,g);b.slide.is(b.slideNext)||(q=!0,w(),((g=I?I.call(b,a):!0)||"undefined"===typeof g)&&u(B(h),c.isCarousel?c.time:0,function(){P(a)}))}a?d.is(b.slide)||a.preventDefault():n()}function u(a,e,d,g){null===a&&(a=B(b.index));e=e||0;if(X&&c.isCarousel){g=g||0;if(e&&d)l.one(m.toLowerCase()+"TransitionEnd transitionend",d);x[m+"Transition"]=e?e/1E3+"s":"";x[m+"Transform"]="translateX("+-1*(y(a,!0)-g)+"%)";!e&&d&&d()}else l.stop(!0,!0).animate({left:y(a)+"%"},e,d)}function P(a){b.slide=
	b.slideNext;q=!1;f.removeClass(c.classActive);b.slide.addClass(c.classActive);x[m+"Transition"]="";c.canLoop&&Q();R();a&&("click"===a.type&&b.slide.focus(),H&&H.call(b,a))}function W(a){var e=$(this),d=b.index,g=k-1,e=e.is(v)?c.step:1;"undefined"!==typeof a?(r=a<d?!0:!1,d=a):r?(d-=e,d=0>=d?c.canLoop?z(d):0:d):(d+=e,d=d>=g?c.canLoop?z(d):g:d);b.slideNext=f.eq(d);b.index=d}function S(){return!c.canLoop&&(r&&0===b.index||!r&&b.index===k-1)}function T(a){s&&(a?p.call(this,a,{slide:C.index(this)}):C.removeAttr("class").eq(b.index).addClass(c.classActive))}
	function R(){var a,e=c.classDisabled;if(!c.canLoop){v.removeClass(e);switch(b.index){case 0:a=D;break;case k-1:a=E}a&&a.addClass(e)}T()}function y(a,b){return b?100/k*a:-100*a}function z(a){a>=k&&(a-=k);0>a&&(a=k+a);return a}function B(a){return z(b.index+(c.canLoop?A-a:0))}function U(a){return z(c.canLoop?a-A+b.index:a)}function Q(){for(var a=k,e,d,g;a--;)e=f.eq(U(a)),d=e.data("x"),g=y(a,!0)+"%",g!==d&&e.css({left:g,display:c.display}).attr("tabindex","-1").data("x",g);u(c.canLoop?A:b.index)}function Y(){var a,
	e;function d(d){var g=d.originalEvent,h=g.touches&&g.touches[0]||g;1<h.length||g.scale&&1!==g.scale||(a=(h.pageX||h.screenX)-l.x,e=(h.pageY||h.screenY)-l.y,"undefined"===typeof t&&(t=!!(t||Math.abs(a)<Math.abs(e))),t||(d.preventDefault(),w(),r=0<a,q=!0,!c.canLoop&&S()&&(a/=Math.abs(a)/b.width+1),u(null,null,null,a/b.width*(100/k))))}function g(){if(!t){var e=+new Date-l.time,f=Math.abs(a),e=250>e&&20<f||f>b.width/3;q=!1;e&&!S()?p.call(this,event,{isPrev:r}):0<f&&u(null,c.time)}h.off(m,d);h.off(n,
	g)}function f(a){F&&clearTimeout(F);F=setTimeout(function(){b.width=h.outerWidth()},a?300:0)}var l,m="touchmove MSPointerMove",n="touchend touchleave touchcancel MSPointerUp MSPointerOut";c.isCarousel=!0;h.on("touchstart MSPointerDown",function(b){var c=v||s&&s.add(v),f=b.originalEvent,f=f.touches&&f.touches[0]||f;c.has(b.target).length||c.is(b.target)||(q&&P(),l={x:f.pageX||f.screenX,y:f.pageY||f.screenY,time:+new Date},t=e=a=void 0,h.on(m,d),h.on(n,g))}).on("click",function(a){!t&&q&&a.preventDefault()}).addClass(c.classTouch);
	f();$(window).resize(f)}var b=this,G=["ms","O","Moz","Webkit",""],m="",x,c={next:"button.next",previous:"button.previous",classStrip:"strip",classSlide:"slide",classActive:"sticky",classMarkers:"markers",classDisabled:"disabled",classTouch:"touch",step:1,delay:3E3,interval:5E3,time:400,display:"block",canLoop:!1,isManual:!0,isCarousel:!0},h,f,l,s,C,v,D,E,M,L,F,k,A,q,t,r,K,X=function(){for(var a=document.body.style,b=G.length;b--;)if("string"===typeof a[G[b]+"Transition"]){m=G[b];break}return!!m}();
	J(V||{});b.init=function(){h=$(c.slideshow);f=h.find("."+c.classSlide);l=h.find("."+c.classStrip);k=f.length;if(h.length&&!(2>k)){x=l[0].style;b.slide=f.filter("."+c.classActive);b.index=f.index(b.slide);b.slide.length||(b.index=0,b.slide=f.eq(b.index));A=c.canLoop?Math.floor((k-1)/2):0;l.outerWidth(100*k+"%");f.outerWidth(100/k+"%");K&&Y();f.on("click touchend",p);h.mouseenter(w).mouseleave(n);E=h.find(c.next).on("click touchend",N);D=h.find(c.previous).on("click touchend",O);v=D.add(E);M=setTimeout(n,
	c.delay);if(c.classMarkers){s=$("<div />").addClass(c.classMarkers).on("click touchend","button",T);for(var a=k;a--;)s.prepend($("<button>"+(a+1)+"</button>"));C=s.find("button");h.append(s)}R();Q();b.element=h;b.strip=l;b.slides=f;h.removeClass(c.classDisabled)}};b.start=n;b.stop=w;b.next=N;b.prev=O;b.change=p;b.transition=u;b.getTransitionX=y;b.getIndexOffset=B;b.getPositionOffset=U;b.updateConfig=J};