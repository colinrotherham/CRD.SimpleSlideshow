/*
	Copyright (c) 2012 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};CRD.Slideshow=function(c,g){var b=this;var f,a;var d,e;b.isBusy=false;b.isBackwards=false;b.slideNumber=1;b.init=function(){b.element=$(c.slideshow);if(!b.element.length){return}b.strip=b.element.find("."+c.classStrip);b.slides=b.element.find("."+c.classSlide);if(b.slides.length<2){return}if(c.buttons){b.buttons=b.element.find(c.buttons);b.buttonNext=b.buttons.find(c.buttonNext);b.buttonPrevious=b.buttons.find(c.buttonPrevious)}b.slide=b.slides.eq(b.slideNumber-1);b.strip.width((b.slides.length*100)+"%");b.slides.width((100/b.slides.length)+"%");b.initPositions();b.updateNextPrev();b.initEvents();b.initMarkers();d=setTimeout(b.start,c.delay)};b.start=function(){if(!c.isManual){e=setTimeout(function(){b.change()},c.slideInterval)}};b.stop=function(){clearTimeout(d);clearTimeout(e)};b.change=function(i,h){b.isBackwards=!!(i&&i.data&&i.data.isBackwards);if(!b.isBusy&&(!i||i&&!$(i.target).hasClass("disabled"))){b.getNextSlide(h);if(!b.slide.is(b.slideNext)){b.isBusy=true;b.updateNextPrev();b.updateMarkers();b.transition();b.stop()}}if(!i){b.start()}else{i.preventDefault()}};b.callback=function(){if(typeof g==="function"){g.call(b)}};b.transition=function(){var h=((b.slideNumber-1)*-100)+"%";var i=(c.isCarousel)?c.slideTransition:0;b.strip.animate({left:h},i,b.transitionEnd)};b.transitionEnd=function(){b.slides.removeClass(c.classActive);b.slideNext.addClass(c.classActive);b.slide=b.slideNext;b.isBusy=false;b.callback()};b.getNextSlide=function(h){if(typeof h!=="undefined"){b.slideNext=b.slides.eq(h);b.slideNumber=h+1}else{b.slideNext=(b.isBackwards)?b.slide.prev("."+c.classSlide):b.slide.next("."+c.classSlide);b.slideNumber=(b.isBackwards)?b.slideNumber-1:b.slideNumber+1;if(!b.slideNext.length){if(!c.canLoop){b.isBackwards=!b.isBackwards}b.slideNext=(b.isBackwards)?b.slides.eq(b.slides.length-1):b.slides.eq(0);b.slideNumber=(b.isBackwards)?b.slides.length:1}}};b.updateMarkers=function(i){if(!f){return}var h=b.slideNumber-1;if(i){b.change(i,a.index(this))}else{a.removeAttr("class").eq(h).addClass(c.classActive)}};b.updateNextPrev=function(){if(c.canLoop||!c.buttons){return}b.buttonPrevious.removeClass(c.classDisabled);b.buttonNext.removeClass(c.classDisabled);switch(b.slideNumber){case 1:b.buttonPrevious.addClass(c.classDisabled);break;case b.slides.length:b.buttonNext.addClass(c.classDisabled);break}};b.initPositions=function(){var j=b.slides.length,h;while(j--){h=j*(100/b.slides.length)+"%";b.slides.eq(j).css("left",h).css("display","block")}};b.initMarkers=function(){if(!c.classMarkers){return}f=$("<ul />").addClass(c.classMarkers);var h=b.slides.length;while(h--){f.prepend($('<li><a href="#">'+(h+1)+"</a></li>"))}a=f.find("a");b.element.append(f);b.updateMarkers();a.click(b.updateMarkers);f.show()};b.initEvents=function(){if(c.buttons){b.buttonNext.bind("click",{isBackwards:false},b.change);b.buttonPrevious.bind("click",{isBackwards:true},b.change)}b.element.bind("mouseenter",b.stop);b.element.bind("mouseleave",b.start)}};