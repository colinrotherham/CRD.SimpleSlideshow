/*
	Copyright (c) 2012 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};
	CRD.Slideshow=function(V,I,J){function x(){c.isManual||(K=setTimeout(function(){g()},c.interval))}function y(){clearTimeout(L);clearTimeout(K)}function M(a){g(a,{isPrev:!1})}function N(a){g(a,{isPrev:!0})}function g(a,f){var e=$(this),j=f&&f.slide,g=b.index;if(!m){n=f&&f.isPrev;if(e.hasClass(c.classSlide)){if(e.is("a"))return;j=k.index(e)}var h=b.index;"undefined"!==typeof j?(n=j<h?!0:!1,h=j):h=n?0===h?c.canLoop?d-1:0:h-1:h===d-1?c.canLoop?0:d-1:h+1;b.slideNext=k.eq(h);b.index=h;b.slide.is(b.slideNext)||(m=
	!0,y(),v(r(g),c.isCarousel?c.time:0,function(){O(a)}))}a?e.is(b.slide)||a.preventDefault():x()}function v(a,f,e,d){null===a&&(a=r(b.index));f=f||0;if(P&&c.isCarousel){J&&J.call(b);d=d||0;if(e)s.one(l.toLowerCase()+"TransitionEnd transitionend",e);z[l+"Transition"]=f?f/1E3+"s":"";z[l+"Transform"]="translateX("+-1*(p(a,!0)-d)+"%)"}else s.stop(!0,!0).animate({left:p(a)+"%"},f,e)}function O(a){b.slide=b.slideNext;m=!1;k.removeClass(c.classActive);b.slide.addClass(c.classActive);z[l+"Transition"]="";c.canLoop&&
	Q();R();a&&"click"===a.type&&b.slide.focus();I&&I.call(b)}function S(){return!c.canLoop&&(n&&0===b.index||!n&&b.index===d-1)}function T(a){t&&(a?g(a,{slide:B.index(this)}):B.removeAttr("class").eq(b.index).addClass(c.classActive))}function R(){var a,f=c.classDisabled;if(!c.canLoop){C.removeClass(f);switch(b.index){case 0:a=D;break;case d-1:a=E}a&&a.addClass(f)}T()}function p(a,b){return b?a*(100/d):-100*a}function U(a){a>=d&&(a-=d);0>a&&(a=d+a);return a}function r(a){return U(b.index+(c.canLoop?A-
	a:0))}function Q(){for(var a=d,e,g,j;a--;)e=k.eq(U(c.canLoop?a-A+b.index:a)),g=e.data("x"),j=p(a,!0)+"%",j!==g&&e.css({left:j,display:"block"}).attr("tabindex","-1").data("x",j);v(c.canLoop?A:b.index)}for(var b=this,F=["ms","O","Moz","Webkit",""],l="",z,c={next:"button.next",previous:"button.previous",classStrip:"strip",classSlide:"slide",classActive:"sticky",classMarkers:"markers",classDisabled:"disabled",classTouch:"touch",delay:3E3,interval:5E3,time:400,canLoop:!1,isManual:!0,isCarousel:!0},e,
	k,s,t,B,C,D,E,L,K,G,d,A,m,q,n,P,W=document.body.style,H=F.length;H--;)if("string"===typeof W[F[H]+"Transition"]){l=F[H];break}P=!!l;var X="ontouchstart"in window||navigator.msPointerEnabled||window.DocumentTouch&&document instanceof DocumentTouch;$.each(V,function(a,b){c[a]=b});b.init=function(){var a,f;e=$(c.slideshow);k=e.find("."+c.classSlide);s=e.find("."+c.classStrip);d=k.length;if(e.length&&!(2>d)){z=s[0].style;b.slide=k.filter("."+c.classActive);b.index=k.index(b.slide);b.slide.length||(b.index=
	0,b.slide=k.eq(b.index));A=c.canLoop?Math.floor((d-1)/2):0;s.width(100*d+"%");k.width(100/d+"%");if(X){var l=function(e){var g=e.originalEvent,w=g.touches&&g.touches[0]||g;1<w.length||g.scale&&1!==g.scale||(a=(w.pageX||w.screenX)-h.x,f=(w.pageY||w.screenY)-h.y,"undefined"===typeof q&&(q=!!(q||Math.abs(a)<Math.abs(f))),q||(e.preventDefault(),y(),n=0<a,m=!0,!c.canLoop&&S()&&(a/=Math.abs(a)/b.width+1),v(null,null,null,a/b.width*(100/d))))},j=function(){if(!q){var d=+new Date-h.time,f=Math.abs(a),d=250>
	d&&20<f||f>b.width/3;m=!1;d&&!S()?g(void 0,{isPrev:n}):0<f&&v(null,c.time)}e.off(p,l);e.off(r,j)},u=function(a){G&&clearTimeout(G);G=setTimeout(function(){b.width=e.outerWidth()},a?300:0)},h,p="touchmove MSPointerMove",r="touchend touchleave touchcancel MSPointerUp MSPointerOut";c.isCarousel=!0;e.on("touchstart MSPointerDown",function(b){var c=t.add(C),d=b.originalEvent,d=d.touches&&d.touches[0]||d;!c.has(b.target).length&&!c.is(b.target)&&(m&&O(),h={x:d.pageX||d.screenX,y:d.pageY||d.screenY,time:+new Date},
	q=f=a=void 0,e.on(p,l),e.on(r,j))}).on("click",function(a){!q&&m&&a.preventDefault()}).addClass(c.classTouch);u();$(window).resize(u)}k.on("click touchend",g);e.mouseenter(y).mouseleave(x);E=e.find(c.next).on("click touchend",M);D=e.find(c.previous).on("click touchend",N);C=D.add(E);L=setTimeout(x,c.delay);if(c.classMarkers){t=$("<div />").addClass(c.classMarkers).on("click touchend","button",T);for(u=d;u--;)t.prepend($("<button>"+(u+1)+"</button>"));B=t.find("button");e.append(t)}R();Q();b.element=
	e;b.strip=s;b.slides=k}};b.start=x;b.stop=y;b.next=M;b.prev=N;b.change=g;b.transition=v;b.getTransitionX=p;b.getIndexOffset=r};