/*
	Copyright (c) 2012 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};
	CRD.Slideshow=function(W,I,J){function x(){c.isManual||(K=setTimeout(function(){f()},c.interval))}function y(){clearTimeout(L);clearTimeout(K)}function M(a){f(a,{isPrev:!1})}function N(a){f(a,{isPrev:!0})}function f(a,g){var d=$(this),j=g&&g.slide,f=b.index;if(!m){n=g&&g.isPrev;if(d.hasClass(c.classSlide)){if(d.is("a"))return;j=k.index(d)}var h=b.index;"undefined"!==typeof j?(n=j<h?!0:!1,h=j):h=n?0===h?c.canLoop?e-1:0:h-1:h===e-1?c.canLoop?0:e-1:h+1;b.slideNext=k.eq(h);b.index=h;b.slide.is(b.slideNext)||(m=
	!0,y(),v(r(f),c.isCarousel?c.time:0,function(){O(a)}))}a?d.is(b.slide)||a.preventDefault():x()}function v(a,g,d,e){null===a&&(a=r(b.index));g=g||0;if(P&&c.isCarousel){J&&d&&J.call(b);e=e||0;if(d)s.one(l.toLowerCase()+"TransitionEnd transitionend",d);z[l+"Transition"]=g?g/1E3+"s":"";z[l+"Transform"]="translateX("+-1*(p(a,!0)-e)+"%)"}else s.stop(!0,!0).animate({left:p(a)+"%"},g,d)}function O(a){b.slide=b.slideNext;m=!1;k.removeClass(c.classActive);b.slide.addClass(c.classActive);z[l+"Transition"]="";
	c.canLoop&&Q();R();a&&"click"===a.type&&b.slide.focus();I&&I.call(b)}function S(){return!c.canLoop&&(n&&0===b.index||!n&&b.index===e-1)}function T(a){t&&(a?f(a,{slide:B.index(this)}):B.removeAttr("class").eq(b.index).addClass(c.classActive))}function R(){var a,d=c.classDisabled;if(!c.canLoop){C.removeClass(d);switch(b.index){case 0:a=D;break;case e-1:a=E}a&&a.addClass(d)}T()}function p(a,b){return b?a*(100/e):-100*a}function U(a){a>=e&&(a-=e);0>a&&(a=e+a);return a}function r(a){return U(b.index+(c.canLoop?
	A-a:0))}function V(a){return U(c.canLoop?a-A+b.index:a)}function Q(){for(var a=e,d,f,j;a--;)d=k.eq(V(a)),f=d.data("x"),j=p(a,!0)+"%",j!==f&&d.css({left:j,display:"block"}).attr("tabindex","-1").data("x",j);v(c.canLoop?A:b.index)}for(var b=this,F=["ms","O","Moz","Webkit",""],l="",z,c={next:"button.next",previous:"button.previous",classStrip:"strip",classSlide:"slide",classActive:"sticky",classMarkers:"markers",classDisabled:"disabled",classTouch:"touch",delay:3E3,interval:5E3,time:400,canLoop:!1,isManual:!0,
	isCarousel:!0},d,k,s,t,B,C,D,E,L,K,G,e,A,m,q,n,P,X=document.body.style,H=F.length;H--;)if("string"===typeof X[F[H]+"Transition"]){l=F[H];break}P=!!l;var Y="ontouchstart"in window||navigator.msPointerEnabled||window.DocumentTouch&&document instanceof DocumentTouch;$.each(W,function(a,b){c[a]=b});b.init=function(){var a,g;d=$(c.slideshow);k=d.find("."+c.classSlide);s=d.find("."+c.classStrip);e=k.length;if(d.length&&!(2>e)){z=s[0].style;b.slide=k.filter("."+c.classActive);b.index=k.index(b.slide);b.slide.length||
	(b.index=0,b.slide=k.eq(b.index));A=c.canLoop?Math.floor((e-1)/2):0;s.width(100*e+"%");k.width(100/e+"%");if(Y){var l=function(d){var f=d.originalEvent,w=f.touches&&f.touches[0]||f;1<w.length||f.scale&&1!==f.scale||(a=(w.pageX||w.screenX)-h.x,g=(w.pageY||w.screenY)-h.y,"undefined"===typeof q&&(q=!!(q||Math.abs(a)<Math.abs(g))),q||(d.preventDefault(),y(),n=0<a,m=!0,!c.canLoop&&S()&&(a/=Math.abs(a)/b.width+1),v(null,null,null,a/b.width*(100/e))))},j=function(){if(!q){var e=+new Date-h.time,g=Math.abs(a),
	e=250>e&&20<g||g>b.width/3;m=!1;e&&!S()?f(void 0,{isPrev:n}):0<g&&v(null,c.time)}d.off(p,l);d.off(r,j)},u=function(a){G&&clearTimeout(G);G=setTimeout(function(){b.width=d.outerWidth()},a?300:0)},h,p="touchmove MSPointerMove",r="touchend touchleave touchcancel MSPointerUp MSPointerOut";c.isCarousel=!0;d.on("touchstart MSPointerDown",function(b){var c=t.add(C),e=b.originalEvent,e=e.touches&&e.touches[0]||e;!c.has(b.target).length&&!c.is(b.target)&&(m&&O(),h={x:e.pageX||e.screenX,y:e.pageY||e.screenY,
	time:+new Date},q=g=a=void 0,d.on(p,l),d.on(r,j))}).on("click",function(a){!q&&m&&a.preventDefault()}).addClass(c.classTouch);u();$(window).resize(u)}k.on("click touchend",f);d.mouseenter(y).mouseleave(x);E=d.find(c.next).on("click touchend",M);D=d.find(c.previous).on("click touchend",N);C=D.add(E);L=setTimeout(x,c.delay);if(c.classMarkers){t=$("<div />").addClass(c.classMarkers).on("click touchend","button",T);for(u=e;u--;)t.prepend($("<button>"+(u+1)+"</button>"));B=t.find("button");d.append(t)}R();
	Q();b.element=d;b.strip=s;b.slides=k}};b.start=x;b.stop=y;b.next=M;b.prev=N;b.change=f;b.transition=v;b.getTransitionX=p;b.getIndexOffset=r;b.getPositionOffset=V};