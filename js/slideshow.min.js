/*
	Copyright (c) 2012 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};CRD.Slideshow=function(d,o){var p=this;var e,q;var m,c,b=false,n=false;p.init=function(){p.element=$(d.slideshow);p.strip=p.element.find("."+d.classStrip);p.slides=p.element.find("."+d.classSlide);if(!p.element.length||p.slides.length<2){return}if(d.buttons){p.buttons=p.element.find(d.buttons);p.buttonNext=p.buttons.find(d.buttonNext);p.buttonPrevious=p.buttons.find(d.buttonPrevious)}p.strip.width((p.slides.length*100)+"%");p.slides.width((100/p.slides.length)+"%");p.slide=p.slides.filter("."+d.classActive);p.slideNumber=p.slides.index(p.slide)+1;if(!p.slide.length){p.slideNumber=1;p.slide=p.slides.eq(p.slideNumber-1).addClass(d.classActive)}j();i();k();f();m=setTimeout(p.start,d.delay)};p.start=function(){if(!d.isManual){c=setTimeout(function(){p.change()},d.slideInterval)}};p.stop=function(){clearTimeout(m);clearTimeout(c)};p.change=function(u,t){n=!!(u&&u.data&&u.data.isBackwards);var s=$(this);if(!b&&(!u||u&&!s.hasClass(d.classDisabled))){if(s.hasClass(d.classSlide)){if(s.is("a")){return}t=p.slides.index(s)}g(t);if(!p.slide.is(p.slideNext)){b=true;j();h();var v=(d.isCarousel)?d.slideTransition:0;var r=function(){a(u)};p.transition(v,r);p.stop()}}if(!u){p.start()}else{u.preventDefault()}};p.callback=function(){if(typeof o==="function"){o.call(p)}};p.transition=function(s,r){p.strip.animate({left:l()},s,r)};function a(r){p.slides.removeClass(d.classActive);p.slideNext.addClass(d.classActive);p.slide=p.slideNext;b=false;if(r&&r.type==="click"){p.slide.focus()}p.callback()}function l(){return((p.slideNumber-1)*-100)+"%"}function g(s){var r=p.slide,t=p.slides,v=p.slideNumber,u=t.length;if(typeof s!=="undefined"){r=t.eq(s);v=s+1}else{r=(n)?r.prev("."+d.classSlide):r.next("."+d.classSlide);v=(n)?v-1:v+1;if(!r.length){if(!d.canLoop){n=!n}r=(n)?t.eq(u-1):t.eq(0);v=(n)?u:1}}p.slideNext=r;p.slideNumber=v}function h(s){if(!e){return}var r=p.slideNumber-1;if(s){p.change(s,q.index(this))}else{q.removeAttr("class").eq(r).addClass(d.classActive)}}function j(){if(d.canLoop||!d.buttons){return}p.buttonPrevious.removeClass(d.classDisabled);p.buttonNext.removeClass(d.classDisabled);switch(p.slideNumber){case 1:p.buttonPrevious.addClass(d.classDisabled);break;case p.slides.length:p.buttonNext.addClass(d.classDisabled);break}}function i(){var s=p.slides.length,r;while(s--){r=s*(100/p.slides.length)+"%";p.slides.eq(s).css("left",r).css("display","block").attr("tabindex","-1")}p.strip.css({left:l()})}function f(){if(!d.classMarkers){return}e=$("<ul />").addClass(d.classMarkers);var r=p.slides.length;while(r--){e.prepend($('<li><a href="#" role="button">'+(r+1)+"</a></li>"))}q=e.find("a");p.element.append(e);h();q.click(h);e.show()}function k(){if(d.buttons){p.buttonNext.bind("click",{isBackwards:false},p.change);p.buttonPrevious.bind("click",{isBackwards:true},p.change)}p.slides.click(p.change);p.element.bind("mouseenter",p.stop);p.element.bind("mouseleave",p.start)}};