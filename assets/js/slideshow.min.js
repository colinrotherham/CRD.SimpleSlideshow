/*
	Copyright (c) 2012 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};
	CRD.Slideshow=function(Q,F){function t(){b.isManual||(G=setTimeout(function(){k()},b.interval))}function u(){clearTimeout(H);clearTimeout(G)}function I(a){k(a,{isPrev:!1})}function J(a){k(a,{isPrev:!0})}function k(e,c){var f=$(this),n=c&&c.slide;g=!(!c||!c.isPrev);if(!v&&(!e||e&&!f.hasClass(b.classDisabled))){if(f.hasClass(b.classSlide)){if(f.is("a"))return;n=d.index(f)}var l=a.slide,k=b.classSlide,h=a.number,j=d.length;"undefined"!==typeof n?(l=d.eq(n),h=n+1):(l=g?l.prev("."+k):l.next("."+k),h=g?
	h-1:h+1,l.length||(b.canLoop||(g=!g),l=g?d.eq(j-1):d.eq(0),h=g?j:1));a.slideNext=l;a.number=h;a.slide.is(a.slideNext)||(v=!0,u(),K(),s(b.isCarousel?b.time:0,function(){L(e)}))}e?f.is(a.slide)||e.preventDefault():t()}function s(a,d,c){if(M&&b.isCarousel){c=c||0;if(d)q.one(m.toLowerCase()+"TransitionEnd transitionend",d);w[m+"Transition"]=a?a/1E3+"s":"";w[m+"Transform"]="translateX("+-1*(x(null,!0)-c)+"%)"}else q.animate({left:x()+"%"},a,d)}function L(e){d.removeClass(b.classActive);a.slideNext.addClass(b.classActive);
	a.slide=a.slideNext;v=!1;w[m+"Transition"]="";e&&"click"===e.type&&a.slide.focus();y();F&&F.call(a)}function x(b,c){b=0===b||b?b:a.number-1;return c?b*(100/d.length):-100*b}function N(){return g&&1===a.number||!g&&a.number===d.length}function y(c){r&&(c?k(c,{slide:z.index(this)}):z.removeAttr("class").eq(a.number-1).addClass(b.classActive))}function K(){if(!b.canLoop&&!A)switch(O.removeClass(b.classDisabled),a.number){case 1:B.addClass(b.classDisabled);break;case d.length:C.addClass(b.classDisabled)}}
	function P(b){D&&clearTimeout(D);D=setTimeout(function(){a.width=c.outerWidth()},b?300:0)}for(var a=this,p=["ms","O","Moz","Webkit",""],m=p[p.length],w,b={next:"button.next",previous:"button.previous",classStrip:"strip",classSlide:"slide",classActive:"sticky",classMarkers:"markers",classDisabled:"disabled",classTouch:"touch",delay:3E3,interval:5E3,time:400,canLoop:!0,isManual:!0,isCarousel:!0},c,d,q,r,z,O,B,C,H,G,D,v,g,M,R=document.body.style,E=p.length;E--;)if("string"===typeof R[p[E]+"Transition"]){m=
	p[E];break}M=!!m;var A="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;$.each(Q,function(a,c){b[a]=c});a.element=c;a.strip=q;a.slides=d;a.init=function(){c=$(b.slideshow);d=c.find("."+b.classSlide);q=c.find("."+b.classStrip);if(c.length&&!(2>d.length)){w=q[0].style;a.slide=d.filter("."+b.classActive);a.number=d.index(a.slide)+1;a.slide.length||(a.number=1,a.slide=d.eq(a.number-1).addClass(b.classActive));A&&(b.canLoop=!1,b.isCarousel=!0,c.addClass(b.classTouch));q.width(100*
	d.length+"%");d.width(100/d.length+"%");for(var e=d.length,m;e--;)m=x(e,!0)+"%",d.eq(e).css({left:m,display:"block"}).attr("tabindex","-1");s(0);c.mouseenter(u).mouseleave(t);if(A){var f,n,l=function(b){var c=b.originalEvent,e=c.touches[0];1<e.length||c.scale&&1!==c.scale||(f=e.pageX-h.x,n=e.pageY-h.y,"undefined"===typeof j&&(j=!!(j||Math.abs(f)<Math.abs(n))),j||(b.preventDefault(),u(),g=0<f,N()&&(f/=Math.abs(f)/a.width+1),s(0,void 0,f/a.width*(100/d.length))))},p=function(){j||((250>+new Date-h.time&&
	20<Math.abs(f)||Math.abs(f)>a.width/3)&&!N()?k(void 0,{isPrev:g}):s(b.time));c.off("touchmove");c.off("touchend touchcancel")},h,j;c.on("touchstart",function(a){var b=a.originalEvent.touches[0];r.has(a.target).length||(v&&L(),h={x:b.pageX,y:b.pageY,time:+new Date},j=n=f=void 0,c.on("touchmove",l),c.on("touchend touchcancel",p))});c.on("click",function(a){j||a.preventDefault()});$(window).resize(P)}else d.click(k),C=c.find(b.next).on("click",I),B=c.find(b.previous).on("click",J),O=B.add(C).css("display",
	"block");if(b.classMarkers){r=$("<div />").addClass(b.classMarkers).on("click touchstart","button",y);for(e=d.length;e--;)r.prepend($("<button>"+(e+1)+"</button>"));z=r.find("button");c.append(r)}K();y();P();H=setTimeout(t,b.delay)}};a.start=t;a.stop=u;a.next=I;a.prev=J;a.transition=s;a.getTransitionX=x};