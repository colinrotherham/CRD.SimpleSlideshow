/*
	Copyright (c) 2012 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};CRD.Slideshow=function(H,z){function q(){c.isManual||(A=setTimeout(function(){g()},c.interval))}function u(){clearTimeout(B);clearTimeout(A)}function g(b,d){h=!(!b||!b.data||!b.data.isBack);var e=$(this);if(!v&&(!b||b&&!e.hasClass(c.classDisabled))){if(e.hasClass(c.classSlide)){if(e.is("a"))return;d=a.slides.index(e)}var e=d,f=a.slide,l=a.slides,g=c.classSlide,k=a.number,j=l.length;"undefined"!==typeof e?(f=l.eq(e),k=e+1):(f=h?f.prev("."+g):f.next("."+g),k=h?k-1:k+1,f.length||(c.canLoop||(h=!h),f=h?l.eq(j-1):l.eq(0),k=h?j:1));a.slideNext=f;a.number=k;a.slide.is(a.slideNext)||(v=!0,C(),r(c.isCarousel?c.time:0,function(){a.slides.removeClass(c.classActive);a.slideNext.addClass(c.classActive);a.slide=a.slideNext;v=!1;s[n+"Transition"]="";b&&"click"===b.type&&a.slide.focus();z&&z.call(a)}),u())}b?b.preventDefault():q()}function r(b,c,e){D?(s[n+"Transition"]=b?b/1E3+"s":"",s[n+"Transform"]="translateX("+-1*(t(null,!0)-(e||0))+"%)"):a.strip.animate({left:t()+"%"},b);c&&setTimeout(c,b)}function t(b,c){b=0===b||b?b:a.number-1;return c?b*(100/a.slides.length):-100*b}function E(b){m&&(b?g(b,w.index(this)):w.removeAttr("class").eq(a.number-1).addClass(c.classActive))}function C(){if(!c.canLoop)switch(a.previous.add(a.next).removeClass(c.classDisabled),a.number){case 1:a.previous.addClass(c.classDisabled);break;case a.slides.length:a.next.addClass(c.classDisabled)}E()}function F(b){x&&clearTimeout(x);x=setTimeout(function(){a.width=a.element.outerWidth()},b?300:0)}for(var a=this,p=["ms","O","Moz","Webkit",""],n=p[p.length],c={next:"button.next",previous:"button.previous",classStrip:"strip",classSlide:"slide",classActive:"sticky",classMarkers:"markers",classDisabled:"disabled",delay:3E3,interval:5E3,time:600,canLoop:!0,isManual:!0,isCarousel:!0},m,w,B,A,x,s,v,h,D,I=document.body.style,y=p.length;y--;)"string"===typeof I[p[y]+"Transition"]&&(n=p[y]);D=!!n;var G="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;$.each(H,function(a,d){c[a]=d});a.init=function(){var b=$(c.slideshow),d=b.find("."+c.classSlide),e=b.find("."+c.classStrip);if(b.length&&!(2>d.length)){a.slide=d.filter("."+c.classActive);a.number=d.index(a.slide)+1;a.slide.length||(a.number=1,a.slide=d.eq(a.number-1).addClass(c.classActive));a.element=b;a.strip=e;a.slides=d;G||(a.next=b.find(c.next).show(),a.previous=b.find(c.previous).show());s=e[0].style;a.strip.width(100*a.slides.length+"%");a.slides.width(100/a.slides.length+"%");for(b=a.slides.length;b--;)d=t(b,!0)+"%",a.slides.eq(b).css({left:d,display:"block"}).attr("tabindex","-1");r(0);a.element.mouseenter(u).mouseleave(q);if(G){var f,l,h,k,j,b=a.element,d="."+c.classStrip;b.on("touchstart",d,function(a){a=a.originalEvent.touches[0];h=a.pageX;k=a.pageY;j=l=f=void 0});b.on("touchmove",d,function(b){var c=b.originalEvent,d=c.touches[0];1<d.length||c.scale&&1!==c.scale||(f=d.pageX-h,l=d.pageY-k,"undefined"===typeof j&&(j=!!(j||Math.abs(f)<Math.abs(l))),j||b.preventDefault(),r(0,function(){},f/a.width*(100/a.slides.length)))});b.on("touchend touchcancel",d,function(){j||g()});b.on("click",d,function(a){j||a.preventDefault()});$(window).resize(F)}else a.slides.click(g),a.next.on("click",{isBack:!1},g),a.previous.on("click",{isBack:!0},g);if(c.classMarkers){m=$("<ul />").addClass(c.classMarkers);for(b=a.slides.length;b--;)m.prepend($('<li><a href="#" role="button">'+(b+1)+"</a></li>"));w=m.find("a").click(E);a.element.append(m);m.show()}C();F();B=setTimeout(q,c.delay)}};a.start=q;a.stop=u;a.change=g;a.transition=r;a.getTransitionX=t};