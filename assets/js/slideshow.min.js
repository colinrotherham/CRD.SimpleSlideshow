/*
	Copyright (c) 2014 Colin Rotherham, http://colinr.com
	https://github.com/colinrotherham
*/

	var CRD=CRD||{};
	CRD.Slideshow=function(aa,I,J){function K(a){$.each(a,function(a,b){d[a]=b});L="undefined"!==typeof d.isTouch?!!d.isTouch:"ontouchstart"in window||navigator.msPointerEnabled||window.DocumentTouch&&document instanceof DocumentTouch}function w(){d.isManual||(M=s(function(){m()},d.interval))}function x(){clearTimeout(N);clearTimeout(M)}function s(a,b){return setTimeout(a,b||0)}function O(a){m.call(this,a,{isPrev:!1})}function P(a){m.call(this,a,{isPrev:!0})}function m(a,c){var e=b.index,Q=d.isCarousel?
	d.time:0;if(!n&&(p=c&&c.isPrev,ba.call(this,c&&c.slide),!b.slide.is(b.slideNext))){var f=J?J.call(b,a):!0;if(f||"undefined"===typeof f)n=!0,x(),a&&"hashchange"===a.type&&(Q=0),t(B(e),Q,function(){R(a)})}a?a.preventDefault():w()}function t(a,c,e,f){function g(){C=!1;a||0===a||(a=B(b.index));c=c||0;if(ca&&d.isCarousel){f=f||0;if(c&&e)l.one(k.toLowerCase()+"TransitionEnd transitionend",e);y[k+"Transition"]=c?c/1E3+"s":"";y[k+"Transform"]="translateX("+-1*(z(a,!0)-f)+"%)";!c&&e&&e()}else l.stop(!0,!0).animate({left:z(a)+
	"%"},c,e)}S&&"undefined"!==typeof f?(C=!0,T=requestAnimationFrame(g)):g()}function R(a){b.slide=b.slideNext;n=!1;h.removeClass(d.classActive);b.slide.addClass(d.classActive);y[k+"Transition"]="";d.canLoop&&U();V();a&&("click"!==a.type&&"hashchange"!==a.type||s(function(){b.slide.focus()}),I&&I.call(b,a))}function ba(a){var c=$(this),e=b.index,g=f-1,c=c.is(u)?d.step:1;"undefined"!==typeof a?(p=a<e?!0:!1,e=a):p?(e-=c,e=0>=e?d.canLoop?v(e):0:e):(e+=c,e=e>=g?d.canLoop?v(e):g:e);b.slideNext=h.eq(e);b.index=
	e}function W(){return!d.canLoop&&(p&&0===b.index||!p&&b.index===f-1)}function X(a){r&&(a?m.call(this,a,{slide:D.index(this)}):D.removeAttr("class").eq(b.index).addClass(d.classActive))}function V(){var a,c=d.classDisabled;if(!d.canLoop){u.removeClass(c);switch(b.index){case 0:a=E;break;case f-1:a=F}a&&a.addClass(c)}X()}function z(a,b){return b?100/f*a:-100*a}function v(a){a>=f&&(a-=f);0>a&&(a=f+a);return a}function B(a){return v(b.index+(d.canLoop?A-a:0))}function Y(a){return v(d.canLoop?a-A+b.index:
	a)}function Z(a){var c,e;b.slide||(b.slide=h.filter("."+d.classActive).first(),b.index=h.index(b.slide));location.hash&&(c=h.filter(location.hash),e=h.index(c),c.length&&b.index!==e&&m(a,{slide:e}));b.slide.length||(b.index=0,b.slide=h.eq(b.index));s(function(){g.scrollTop(0);g.scrollLeft(0)})}function U(){for(var a=f,c,e,g;a--;)c=h.eq(Y(a)),e=c.data("x"),g=z(a,!0)+"%",g!==e&&c.css({left:g,display:d.display}).attr("tabindex","-1").data("x",g);t(d.canLoop?A:b.index)}function da(){var a,c;function e(e){var g=
	e.originalEvent,h=g.touches&&g.touches[0]||g;C||1<h.length||g.scale&&1!==g.scale||(a=(h.pageX||h.screenX)-k.x,c=(h.pageY||h.screenY)-k.y,"undefined"===typeof q&&(q=!!(q||Math.abs(a)<Math.abs(c))),q||(e.preventDefault(),x(),p=0<a,n=!0,!d.canLoop&&W()&&(a/=Math.abs(a)/b.width+1),t(null,null,null,a/b.width*(100/f))))}function h(){if(!q){var c=+new Date-k.time,f=Math.abs(a),c=250>c&&20<f||f>b.width/3;n=!1;S&&cancelAnimationFrame(T);c&&!W()?m.call(this,event,{isPrev:p}):0<f&&t(null,d.time)}g.off("touchmove pointermove MSPointerMove",
	e);g.off("touchend touchleave touchcancel MSPointerUp MSPointerOut MSPointerCancel pointerup pointerleave pointercancel",h)}function l(a){G&&clearTimeout(G);G=s(function(){b.width=g.outerWidth()},a?300:0)}var k;d.isCarousel=!0;g.on("touchstart pointerdown MSPointerDown",function(b){var d=u||r&&r.add(u),f=b.originalEvent,f=f.touches&&f.touches[0]||f;d.has(b.target).length||d.is(b.target)||(n&&R(),k={x:f.pageX||f.screenX,y:f.pageY||f.screenY,time:+new Date},q=c=a=void 0,g.on("touchmove pointermove MSPointerMove",
	e),g.on("touchend touchleave touchcancel MSPointerUp MSPointerOut MSPointerCancel pointerup pointerleave pointercancel",h))}).on("click",function(a){!q&&n&&a.preventDefault()}).addClass(d.classTouch);l();$(window).resize(l)}var b=this,H=["ms","O","Moz","Webkit",""],k="",y,d={next:"button.next",previous:"button.previous",markers:".markers",classStrip:"strip",classSlide:"slide",classActive:"sticky",classDisabled:"disabled",classTouch:"touch",step:1,delay:3E3,interval:5E3,time:400,display:"block",canLoop:!1,
	isManual:!0,isCarousel:!0},g,h,l,r,D,u,E,F,N,M,G,T,f,A,n,C,q,p,L,ca=function(){for(var a=document.body.style,b=H.length;b--;)if("string"===typeof a[H[b]+"Transition"]){k=H[b];break}return!!k}(),S=!(!window.requestAnimationFrame||!window.cancelAnimationFrame);K(aa||{});b.init=function(){g=$(d.slideshow);h=g.find("."+d.classSlide);l=g.find("."+d.classStrip);f=h.length;if(g.length&&!(2>f)){y=l[0].style;var a=h.first(),c=100/f+"%";l.outerWidth(100*f+"%");h.outerWidth(c);a.width()&&a.get(0).style.width.slice(0,
	5)===c.slice(0,5)||h.width(c);A=d.canLoop?Math.floor((f-1)/2):0;g.mouseenter(x).mouseleave(w);F=$(d.next).on("click touchend",O);E=$(d.previous).on("click touchend",P);u=E.add(F);N=s(w,d.delay);if(d.markers){r=$(d.markers).on("click touchend","button",X);for(a=f;a--;)r.prepend($("<button>"+(a+1)+"</button>"));D=r.find("button")}Z();U();L&&da();V();b.element=g;b.strip=l;b.slides=h;g.removeClass(d.classDisabled);$(window).on("hashchange",Z)}};b.start=w;b.stop=x;b.next=O;b.prev=P;b.change=m;b.transition=
	t;b.getTransitionX=z;b.getIndexWrapped=v;b.getIndexOffset=B;b.getPositionOffset=Y;b.updateConfig=K};